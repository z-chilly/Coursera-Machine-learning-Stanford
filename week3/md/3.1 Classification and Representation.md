### 6.1 分类问题

参考文档: 6 - 1 - Classification (8 min).mkv

在分类问题中，你要预测的变量 ![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y0rihwzqj300600i0ak.jpg) 是离散的值，我们将学习一种叫做逻辑回归 (**Logistic Regression**) 的算法，这是目前最流行使用最广泛的一种学习算法。

在分类问题中，我们尝试预测的是结果是否属于某一个类（例如正确或错误）。分类问题的例子有：判断一封电子邮件是否是垃圾邮件；判断一次金融交易是否是欺诈；之前我们也谈到了肿瘤分类问题的例子，区别一个肿瘤是恶性的还是良性的。

![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y0rl3fkoj30b403h0td.jpg)

我们从二元的分类问题开始讨论。

我们将因变量(**dependent variable**)可能属于的两个类分别称为负向类（**negative class**）和正向类（**positive class**），则因变量![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y0riy38qj301700g0i6.jpg) ，其中 0 表示负向类，1 表示正向类。

![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y0rlvmqij30b4053dgm.jpg)

如果我们要用线性回归算法来解决一个分类问题，对于分类， ![img](file:////Users/zhouhanqi/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image002.png) 取值为 0 或者1，但如果你使用的是线性回归，那么假设函数的输出值可能远大于 1，或者远小于0，即使所有训练样本的标签 ![img](file:////Users/zhouhanqi/Library/Group%20Containers/UBF8T346G9.Office/TemporaryItems/msohtmlclip/clip_image002.png) 都等于 0 或 1。尽管我们知道标签应该取值0 或者1，但是如果算法得到的值远大于1或者远小于0的话，就会感觉很奇怪。所以我们在接下来的要研究的算法就叫做逻辑回归算法，这个算法的性质是：它的输出值永远在0到 1 之间。

顺便说一下，逻辑回归算法是分类算法，我们将它作为分类算法使用。有时候可能因为这个算法的名字中出现了“回归”使你感到困惑，但逻辑回归算法实际上是一种分类算法，它适用于标签 ![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y0rihwzqj300600i0ak.jpg) 取值离散的情况，如：1 0 0 1。

### 6.2 假说表示

参考视频: 6 - 2 - Hypothesis Representation (7 min).mkv

此前我们说过，希望我们的分类器的输出值在0和1之间，因此，我们希望想出一个满足某个性质的假设函数，这个性质是它的预测值要在0和1之间。

我们引入一个新的模型，逻辑回归，该模型的输出变量范围始终在0和1之间。 逻辑回归模型的假设是： ![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y17pin96j302200j3y9.jpg) 

其中： ![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y17v052yj300700i0as.jpg) 代表特征向量 ![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y17odp9bj300700i0bu.jpg) 代表逻辑函数（**logistic function**)是一个常用的逻辑函数为**S**形函数（**Sigmoid function**），公式为： ![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y17n2o2gj301l00o0qv.jpg)。

**python**代码实现：

import numpy as np

def sigmoid(z):

  return 1 / (1 + np.exp(-z))

该函数的图像为：

![图片包含 文字, 地图  描述已自动生成](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y17vwrjjj308c048t8m.jpg)

合起来，我们得到逻辑回归模型的假设：

对模型的理解： ![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y18nkn4bj301l00i0pv.jpg)。

![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y17t560uj300q00i0j3.jpg)的作用是，对于给定的输入变量，根据选择的参数计算输出变量=1的可能性（**estimated probablity**）即![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y17tmohnj302t00ia9t.jpg) 

例如，如果对于给定的![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y17nvxpej300600i0a7.jpg)，通过已经确定的参数计算得出![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y17qbyh3j301h00i0qa.jpg)，则表示有70%的几率![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y17r7y2uj300600i0ak.jpg)为正向类，相应地![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y17r7y2uj300600i0ak.jpg)为负向类的几率为1-0.7=0.3。

### 6.3 判定边界

参考视频: 6 - 3 - Decision Boundary (15 min).mkv

现在讲下决策边界(**decision boundary**)的概念。这个概念能更好地帮助我们理解逻辑回归的假设函数在计算什么。

![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y186a9mtj30go05qjsk.jpg)

现在假设我们有一个模型：

![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y18509j9j30go05qjsk.jpg)

并且参数![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y185q94xj300600i0ar.jpg) 是向量[-3 1 1]。 则当![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y186mfxbj302600i0sh.jpg)，即![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y1877e4rj301g00i0mh.jpg)时，模型将预测 ![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y183yl9kj300q00i0eg.jpg)。 我们可以绘制直线![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y189fxmij301g00i0lh.jpg)，这条线便是我们模型的分界线，将预测为1的区域和预测为 0的区域分隔开。

![图片包含 文字  描述已自动生成](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y1884v1lj305k04pmx8.jpg)

假使我们的数据呈现这样的分布情况，怎样的模型才能适合呢？

![图片包含 文字  描述已自动生成](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y18ekdxzj306p04zmx8.jpg)

因为需要用曲线才能分隔 ![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y18drz74j300q00i0fh.jpg) 的区域和 ![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y18f1lpkj300q00i0eg.jpg) 的区域，我们需要二次方特征：![img](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y18bwi2ij305i00j3ya.jpg)是[-1 0 0 1 1]，则我们得到的判定边界恰好是圆点在原点且半径为1的圆形。

我们可以用非常复杂的模型来适应非常复杂形状的判定边界。

![/var/folders/7j/l70rjhts1_74y184b5l9lmnr0000gn/T/com.microsoft.Word/Content.MSO/A753F6B2.tmp](https://tva1.sinaimg.cn/large/006tNbRwgy1g9y18cwgi3j30qo0f0767.jpg)